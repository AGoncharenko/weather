<%= turbo_frame_tag "forecast" do %>
  <div>
    <h2>Forecast for <%= result[:resolved_name] %></h2>
    <p class="address-info">(You searched: <%= result[:address] %>)</p>

    <div class="cache-status <%= result[:cache_hit] ? 'cache-hit' : 'fresh-data' %>">
      <strong><%= result[:cache_hit] ? 'âš¡ Cache Hit' : 'ðŸ”„ Fresh Data' %></strong>
      - Data <%= result[:cache_hit] ? 'retrieved from cache' : 'fetched from API' %>
      <% if result[:cached_at] %>
        at <%= result[:cached_at].strftime('%Y-%m-%d %H:%M:%S') %>
      <% end %>
    </div>

    <section class="forecast-section">
      <h3>Current</h3>
      <ul>
        <li>Temperature: <%= result[:current][:temperature] %> Â°F</li>
        <li>Wind: <%= result[:current][:windspeed] %> mph</li>
        <li>As of: <%= result[:current][:time] %></li>
      </ul>
    </section>

    <section class="forecast-section">
      <h3>Next Days</h3>
      <table class="forecast-table">
        <thead>
        <tr>
          <th>Date</th>
          <th>Min Â°F</th>
          <th>Max Â°F</th>
          <th>Precip (mm)</th>
        </tr>
        </thead>
        <tbody>
        <% result[:daily].each do |d| %>
          <tr>
            <td><%= d[:date] %></td>
            <td><%= d[:tmin] %></td>
            <td><%= d[:tmax] %></td>
            <td><%= d[:precipitation_mm] %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </section>

    <p class="metadata">
      Cached via Redis for ~30 minutes for this address.
    </p>
  </div>
<% end %>
