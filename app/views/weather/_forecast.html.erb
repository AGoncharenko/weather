<%= turbo_frame_tag "forecast" do %>
  <div>
    <h2>Forecast for <%= result[:resolved_name] %></h2>
    <p style="color:#555;">(You searched: <%= result[:address] %>)</p>

    <div style="background-color: <%= result[:cache_hit] ? '#d4edda' : '#fff3cd' %>;
                border: 1px solid <%= result[:cache_hit] ? '#c3e6cb' : '#ffeeba' %>;
                color: <%= result[:cache_hit] ? '#155724' : '#856404' %>;
                padding: 8px 12px;
                border-radius: 4px;
                margin: 1rem 0;
                font-size: 0.9rem;">
      <strong><%= result[:cache_hit] ? 'âš¡ Cache Hit' : 'ðŸ”„ Fresh Data' %></strong>
      - Data <%= result[:cache_hit] ? 'retrieved from cache' : 'fetched from API' %>
      <% if result[:cached_at] %>
        at <%= result[:cached_at].strftime('%Y-%m-%d %H:%M:%S') %>
      <% end %>
    </div>

    <section style="margin: 1rem 0;">
      <h3>Current</h3>
      <ul>
        <li>Temperature: <%= result[:current][:temperature] %> Â°F</li>
        <li>Wind: <%= result[:current][:windspeed] %> mph</li>
        <li>As of: <%= result[:current][:time] %></li>
      </ul>
    </section>

    <section style="margin: 1rem 0;">
      <h3>Next Days</h3>
      <table border="1" cellpadding="6" cellspacing="0">
        <thead>
        <tr>
          <th>Date</th>
          <th>Min Â°F</th>
          <th>Max Â°F</th>
          <th>Precip (mm)</th>
        </tr>
        </thead>
        <tbody>
        <% result[:daily].each do |d| %>
          <tr>
            <td><%= d[:date] %></td>
            <td><%= d[:tmin] %></td>
            <td><%= d[:tmax] %></td>
            <td><%= d[:precipitation_mm] %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </section>

    <p style="color:#777; font-size: 0.9rem;">
      Cached via Redis for ~30 minutes for this address.
    </p>
  </div>
<% end %>
